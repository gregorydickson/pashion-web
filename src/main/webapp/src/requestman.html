<!-- requestman.html -->
<template>
    <require from="./common/viewDateFormatter"></require>
    <require from="./calendars/datepicker"></require>
    <!-- Main building block -->
   <!-- <div class="vertical grid-block spa-background">

        
        <compose view-model="header"></compose> 
        
        <div class="grid-block shrink spa-v-spacer ">
        </div> -->
        <div class="grid-block" style="overflow:visible;">
            <!-- -->
            <!-- Request Panel -->
            <!-- -->
            <div id="request-panel" class="grid-block noscroll vertical grid-block-vertical-shadow ">
                <!-- header -->

                <div class="grid-block tool-header shrink ">
                    <div style="margin-left:34px;" class="grid-block tool-header tool-header-spacer"> <!-- compensate for expando -->
                    </div>
                    <div class="grid-block align-left tool-header-spacer">
                        <span class="ui-text-label-m-broad ">REQUEST MANAGER</span>
                       <!-- <span class="alert-box">3</span> -->
                    </div>
                    <div class="grid-block align-right tool-header-spacer shrink">
                        <span class="expando">
                      <a route-href="route: index;"><img  src="/assets/nav/collapso.png" /></a>
                    </span>
                    </div>
                </div>
                <div class="grid-block">
                    <!-- First Column -->
                    <!-- Calendar + Image detail -->
                    <!-- -->
                    <div id="left-panel" class="vertical grid-block noscroll">
                        <!-- Calendar -->
                       <!-- <div class="grid-block shrink">
                            <compose view-model="calendars/requestCalendar"></compose>
                        </div> -->
                        <!-- Image holder -->
                        <div class="request-image-fix " style="
                              background-image: url('${image}');
                              background-position: left top;
                              min-width:258px;
                              max-width:258px;
                              min-height:400px;
                              max-height:400px;">
                        </div>
                        <!-- Image information holder -->
                        <div class="request-image-info-fix" style="
                                    text-align: center;
                                    overflow: hidden;
                                    margin-top:5px;
                                    min-width:290px;
                                    max-width:290px;
                                    min-height:100px;
                                    max-height:100px;">
                            <span if.bind="brand" class="accordion-grey" style="font-size: 1.1rem; font-weight: 500;">${brand} Look ${look}</span>
                            <br>
                            <span class="accordion-grey">${season}</span>
                            <br>
                        </div>
                    </div>
                    <!-- spacers -->
                    <div class="grid-block shrink spa-h-spacer">
                    </div>
                    <!-- 2nd Column -->
                    <!-- -->
                    <div class="grid-block vertical">
                        <!-- search and filter requests -->
                        <div class="grid-block shrink" style="margin-left: 1rem; margin-right: 1rem; margin-top:1.5rem;">
                            <div class="grid-block">
                                <!-- Search requests -->
                                <input type="search" value.two-way="searchtext" class="search-box" id="search-requests" placeholder="Search Text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search Text'">
                            </div>
                            <div class="grid-block align-center">
                                <!-- filter requests -->
                                <span class="inline-label">
                                  <span class="form-label">Filter</span>
                                <select name="" id="">
                                    <option>Overdue</option>
                                    <option>All</option>
                                </select>
                                </span>
                            </div>
                            <div class="grid-block">
                                <!-- order results -->
                                <span class="inline-label">
                                  <span class="form-label">Order</span>
                                <select name="" id="">
                                    <option>By Date</option>
                                    <option>By Person</option>
                                    <option>By Request ID</option>
                                </select>
                                </span>
                            </div>
                        </div>
                        <!-- Accordion -->
                        <!--Header -->
                        
                            <div if.bind="user.type === 'brand'"  class="grid-content shrink" style="overflow-x: hidden; overflow-y: scroll; padding:0; margin-left:1rem; margin-right:1rem; margin-top:1rem;">
                                <table class="big-accordion">
                                    <tr>
                                        <td class="accordion-underline w3"></td>
                                        <td class="accordion-underline w4">ID</td>
                                        <td class="accordion-underline w11">DUE DATE</td>
                                        <td class="accordion-underline w25">SHOOT</td>
                                        <td class="accordion-underline w14">COMPANY</td>
                                        <td class="accordion-underline w13">WHO</td>
                                        <td class="accordion-underline w5">#</td>
                                        <td class="accordion-underline w14">STATUS</td>
                                        <td class="accordion-underline w5"></td>
                                    </tr>
                                </table>
                            </div>
                            <div if.bind="user.type === 'press'"  class="grid-content shrink" style="overflow-x: hidden; overflow-y: scroll; padding:0; margin-left:1rem; margin-right:1rem; margin-top:1rem;">
                                <table class="big-accordion">
                                    <tr>
                                        <td class="accordion-underline w3"></td>
                                        <td class="accordion-underline w4">ID</td>
                                        <td class="accordion-underline w11">REQUESTED</td>
                                        <td class="accordion-underline w15">BRAND</td>
                                        <td class="accordion-underline w24">EDITORIAL</td>
                                        <td class="accordion-underline w13">OWNER</td>
                                        <td class="accordion-underline w5">#</td>
                                        <td class="accordion-underline w14">STATUS</td>
                                        <td class="accordion-underline w5"></td>
                                    </tr>
                                </table>
                            </div>                            
                            <!-- Content Container-->
                            <!-- Rows of content BRAND View-->
                            <div class="grid-content" style="overflow-x: hidden; overflow-y: scroll; padding:0; margin-left: 1rem; margin-right: 1rem;">
                                
                                <div repeat.for="booking of bookings">
                                    <table  class="big-accordion">
                                        <tr>
                                            <td class="accordion-grey w3">
                                                <button id="button${$index}" class="accordion" click.delegate="closeExpand($index,booking)"></button>
                                            </td>
                                            <td class="accordion-grey w4">${booking.id}</td>
                                            <td class="accordion-grey w11">${booking.bookingStartDate | viewDateFormat}</td>
                                            <td if.bind="user.type === 'press'" class="accordion-grey w14">${booking.brand.name}</td>
                                            <td if.bind="booking.editorialName" class="accordion-grey w25">${booking.editorialName}</td>
                                            <td if.bind="!booking.editorialName" class="accordion-grey w25">n/a</td>
                                            <td if.bind="user.type === 'brand'" class="accordion-grey w14">${booking.pressHouse.name}</td>
                                            <td class="accordion-grey w13">${booking.requestingUser.name} ${booking.requestingUser.surname}</td>
                                            <td class="accordion-grey w5">${booking.searchableItems.length}</td>
                                            <td if.bind="user.type === 'press'" class="accordion-grey w14">${booking.requestStatusPress}</td>
                                            <td if.bind="user.type === 'brand'" class="accordion-grey w14">${booking.requestStatusBrand}</td>
                                            <td class="accordion-grey w5">
                                                <div class="look-menu-absolute-wrap">
                                                    <span class="edit-box" ><a href="#" click.delegate="lookEditMenu(booking.id)">...</a></span>
                                                    <!-- edit request modal popup -->
                                                     <div class="look-menu-absolute" id="requestManTest${booking.id}">
                                                        <span class="look-menu-heading">REQUEST ${booking.id}</span>
                                                        <ul if.bind="user.type === 'brand'"  class="look-menu-list">
                                                            <li class="look-menu-item"><a click.delegate="editSampleRequest(booking.id)" href="#" class="look-menu-link">Edit</a></li>
                                                            <li if.bind="booking.requestStatusBrand === 'Pending'" class="look-menu-item"><a click.delegate="denySampleRequest(booking.id)" href="#" class="look-menu-link">Deny</a></li>                                            
                                                            <li if.bind="booking.requestStatusBrand === 'Pending'" class="look-menu-item"><a click.delegate="approveSampleRequest(booking.id)" href="#" class="look-menu-link">Approve</a></li>
                                                            <li class="look-menu-item"><a click.delegate="sendSampleRequest(booking.id)" href="#" class="look-menu-link">Send</a></li>
                                                            <li class="look-menu-item"><a click.delegate="markPickedUpSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Picked Up</a></li>
                                                            <li class="look-menu-item"><a click.delegate="markReturnedSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Returned</a></li>
                                                            <li class="look-menu-item"><a click.delegate="restockedSampleRequest(booking.id)" href="#" class="look-menu-link">Restocked</a></li>
                                                            <li class="look-menu-item"><a click.delegate="deleteSampleRequest(booking.id)" href="#" class="look-menu-link">Delete Request</a></li>
                                                        </ul>

                                                        <ul if.bind="user.type === 'press'" class="look-menu-list">
                                                            <li class="look-menu-item"><a href="#" click.delegate="editSampleRequest(booking.id)" class="look-menu-link">Edit</a></li>
                                                            <li class="look-menu-item"><a href="#" click.delegate="pressMarkReceivedSampleRequest(booking.id)" class="look-menu-link">Mark Received</a></li>
                                                            <li class="look-menu-item"><a href="#" click.delegate="pressShipSampleRequest(booking.id)"  class="look-menu-link">Ship</a></li>
                                                            <li class="look-menu-item"><a href="#" click.delegate="pressMarkPickedUpSampleRequest(booking.id)"  class="look-menu-link">Mark Picked Up</a></li>
                                                            <li class="look-menu-item"><a href="#" click.delegate="pressDeleteSampleRequest(booking.id)"  class="look-menu-link">Delete Request</a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </td>

                                        </tr>
                                    </table>

                                    <!-- expanding data -->
                                    <div id="panel${$index}" class="panel grid-block vertical" style="margin-left: 0.5rem; margin-top:0.5rem;">
                                        <div class="grid-content">
                                            <span>EDITORIAL</span>
                                        </div>
                                        <div class="grid-content">
                                            <span if.bind="(booking.editorialName || booking.editorialWho || booking.editorialWhen)">Photo shoot ${booking.editorialName} ${booking.editorialWho} ${booking.editorialWhen}</span>
                                            <span if.bind="(!booking.editorialName && !booking.editorialWho && !booking.editorialWhen)">No details of editorial</span>
                                        </div>
                                        <div class="grid-content" style="margin-top:1rem;">
                                            <span>SHIPPING OUT: ID ${booking.shippingOut.id} ${booking.shippingOut.tracking}</span>
                                        </div>
                                        <div class="grid-content">
                                            <span class="ui-text-label-m-blue">${booking.shippingOut.status}</span>
                                            <span>for ${booking.bookingStartDate | viewDateFormat} ${booking.requiredBy} by ${booking.courierOut} (${booking.paymentOut}) to  ${booking.deliverTo.pressHouse.name} ${booking.deliverTo.prAgency.name} ${booking.deliverTo.brand.name} at ${booking.addressDestination.address1}, ${booking.addressDestination.address2}, ${booking.addressDestination.city}, ${booking.addressDestination.postalCode} </span>
                                            <span if.bind="booking.pickedupAt.addressDestination.name"> (${booking.addressDestination.name)</span> 
                                            <span if.bind="booking.pickedupAt"> at ${booking.pickedupAt} signed ${booking.signedBy} </span>
                                        </div>
                                        <div class="grid-content" style="margin-top:1rem;">
                                            <span>RETURN: ID ${booking.shippingReturn.id} ${booking.shippingReturn.tracking}</span>
                                        </div>
                                        <div class="grid-content">
                                            <span class="ui-text-label-m-blue">${booking.shippingReturn.status}</span>
                                            <span>for ${booking.bookingEndDate | viewDateFormat} ${booking.returnBy} by ${booking.courierReturn} (${booking.paymentReturn}) </span>
                                            <span if.bind="booking.returnToAddress">coming back to ${booking.returnToAddress.name} </span>
                                            <span if.bind="!booking.returnToAddress">coming back to here</span>
                                            <span if.bind="booking.returnToName"> to ${booking.returnToName} ${booking.returnToSurname}</span>
                                            <span if.bind="!booking.returnToName"> to me</span>
                                        </div>
                                        <div class="grid-content" style="margin-top:1rem;">
                                            <span>SAMPLES:</span><span style="margin-left:0.5rem;">${booking.searchableItems.length}</span>
                                        </div>
                                        <div class="grid-content" style="margin-bottom: 2rem;">
                                        <!-- with sample images 
                                            <table class="" style="table-layout:fixed;">
                                                <tr  style="height:1rem;">
                                                    <td repeat.for="item of booking.searchableItems" class="accordion"><img if.bind="item.image !== undefined"  src="${item.image}" width="60px;" /></td> 
                                                </tr>
                                                <tr  style="height:1rem;">
                                                    <td repeat.for="item of booking.searchableItems" class="accordion sample-padding">${item.id}: ${item.attributes}</td>
                                                </tr>
                                               <tr>
                                                    <td repeat.for="status of booking.searchableItemsStatus" class="accordion sample-padding">${status.brandStatus}</td>
                                                </tr> 
                                            </table> -->
                                            <!-- no images -->
                                            <table class="" style="table-layout:fixed;">
                                                <tr style="height:1rem;" repeat.for="item of booking.searchableItems" >
                                                    <td class="accordion sample-padding">${item.id}: ${item.attributes} ${status.brandStatus}</td>
                                                </tr>
                                            </table>
                                        </div>
                                        
                                    </div>
                                </div>  
                                
                            </div>
                       
                    </div>
                </div>
                <!-- white lip at bottom of scroll region -->
                <div class="grid-content shrink scrolling-lip">
                </div>
            </div>
            <!-- spacer 
            <div class="grid-block shrink spa-h-spacer">
            </div>
            <!-- 
            <!-- Communications Panel  
            <!-- 
            <div id="right-panel" class="vertical grid-block grid-block-vertical-shadow" >
                <!-- Header 
                <compose view-model="comms/commsHeader"></compose>
            </div>
        </div>
        <!-- spacer 
        <div class="grid-content shrink spa-v-spacer">
        </div>
    </div>-->
</template>
