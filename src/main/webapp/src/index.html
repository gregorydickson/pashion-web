<!-- index.html -->
<template>
    <require from="./calendars/datepicker"></require>
    <require from="./common/customSelect"></require>
    <require from="./common/viewDateFormatter"></require>
    <require from="./common/seasonAbbreviationFormatter"></require>
    <require from="./common/seasonAbbreviationIdFormatter"></require>

    <require from="./dashboard_filters/filters-search"></require>
    <require from="./dashboard_filters/filters-available-from"></require>
    <require from="./dashboard_filters/filters-available-to"></require>
    <require from="./dashboard_filters/filters-color"></require>
    <require from="./dashboard_filters/filters-theme"></require>
    <require from="./dashboard_filters/filters-designer"></require>
    <require from="./dashboard_filters/filters-designer-pr"></require>
    <require from="./dashboard_filters/filters-season"></require>
    <require from="./dashboard_filters/filters-season-press"></require>
    <require from="./dashboard_filters/filters-type"></require>
    <require from="./dashboard_filters/filters-city"></require>
    <require from="./dashboard_filters/filters-show-available"></require>
    <require from="./dashboard_filters/filters-order"></require>
    <require from="./dashboard_filters/filters-category"></require>
    <require from="./dashboard_filters/filters-filterrequests"></require>
    <require from="./common/filter"></require>
    <require from="./contacts/sort"></require>


    <!-- start preloader -->
    <div class="preloader" show.bind="busy.active" >
        <div class="sk-spinner sk-spinner-wave">
            <div class="sk-rect1"></div>
            <div class="sk-rect2"></div>
            <div class="sk-rect3"></div>
            <div class="sk-rect4"></div>
            <div class="sk-rect5"></div>
        </div>
    </div>
    <!-- end preloader -->


        <div class="grid-block spa-background" style="overflow:visible;">




<!-- -->
<!-- Image Grid Large Panel-->
<!-- -->

            <div id="looks" class="vertical grid-block grid-block-vertical-shadow" style="overflow:hidden;">
                <!-- Header -->
                <div class="grid-block tool-header shrink ">
                    <div class="grid-block align-left tool-header tool-header-spacer">
                    </div>
                    <div id="comms_panel" class="grid-block align-left tool-header tool-header-spacer shrink">

                        <!-- Header for 'press'-->
                        <span if.bind="user.type == 'press'">
                            <span class="ui-text-label-m-broad">SAMPLE SEARCH (</span>
                            <span if.bind="maxRReached" class="ui-text-label-m-broad"> > </span>
                            <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                        </span> 
                        <!-- Header for 'brand'-->
                        <span if.bind="user.type == 'brand'">
                            <span class="ui-text-label-m-broad">MANAGE SAMPLES (</span>
                            <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                        </span> 
                        <!-- Header for 'prAgency'-->
                        <span if.bind="user.type == 'prAgency'">
                            <span class="ui-text-label-m-broad">MANAGE SAMPLES (</span>
                            <span if.bind="maxRReached" class="ui-text-label-m-broad"> > </span>
                            <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                        </span> 

                        <!-- Header for 'brand'
                        <!-- if.bind bug here, only for brand have to remove '>' -->
                        <!-- <select if.bind="user.type == 'brand'" class="select-transparent" name="" id="imagesFunctionality">
                            <option value="optionSearchImages"> 
                                <span class="ui-text-label-m-broad">IMAGE SEARCH (</span>
                                <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                            </option>
                            <option value="optionManageImages">
                                <span class="ui-text-label-m-broad">MANAGE IMAGES (</span>
                                <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                            </option>
                        </select>-->
                       
                        <!-- Header for 'agency 
                        <select if.bind="user.type == 'agency'" class="select-transparent" name="" id="imagesFunctionality">
                            <option value="optionSearchImages"> 
                                <span class="ui-text-label-m-broad">IMAGE SEARCH (</span>
                                <span if.bind="maxRReached" class="ui-text-label-m-broad"> > </span>
                                <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                            </option>
                            <option value="optionManageImages">
                                <span class="ui-text-label-m-broad">MANAGE IMAGES (</span>
                                <span if.bind="maxRReached" class="ui-text-label-m-broad"> > </span>
                                <span class="ui-text-label-m-broad">${numberImages} Results )</span>
                            </option>
                        </select> -->
                       
                   </div>
                    <div class="grid-block align-right tool-header-spacer" style="padding-right:7px;">
                        <span class="expando">
                      <!-- <a route-href="route: requestman;"><img  src="/assets/nav/collapso.png" /></a> -->
                      <a click.delegate="imageExpando()">
                        <img class="expandoHover"  if.bind="imagePanelSize==3" src="/assets/nav/collapso16.png" />
                        <img class="expandoHover"  if.bind="imagePanelSize==1" src="/assets/nav/expando16.png" />
                        <img class="expandoHover"  if.bind="imagePanelSize==2" src="/assets/nav/expando16.png" />
                      </a>
                    </span>
                    </div>
                </div>
                <!-- search / filter area -->

                <div class="index-filters">
                    <!-- PRESS filters BEGIN -->
                            <div if.bind="user.type === 'press'">
                                    <!-- top row -->
                                    <div class="grid-row">
                                        <!-- <div class="grid-row-col" style="margin-top: 0.5rem;">
                                            <input id="checkbox-search" type="checkbox" checked>
                                        </div> -->
                                        <!-- change to UI, use "All" for each filter instead -->
                                        <!-- Search -->
                                        <div class="grid-row-col">
                                            <input type="search" value.bind="searchText" class="search-box" id="search-images" placeholder="Search">
                                            <!-- <filters-search change.delegate="filterChangeSearch($event)"></filters-search> -->
                                        </div>
                                        <!-- Trending -->
                                        <!--<div class="grid-row-col" >
                                            <input id="checkbox-trending" type="checkbox"><label for="checkbox-trending">Trending</label>
                                        </div> -->
                                        <!-- Trending postponed until later release -->
                                        <!-- Latest -->
                                        <!-- <div class="grid-row-col" >
                                           <input id="checkbox-latest" type="checkbox"><label for="checkbox-latest">Latest</label>
                                        </div> -->
                                        <!-- Latest postponed until later release -->
                                        <!-- Available -->
                                        <!-- end date -->
                                        <div class="grid-row-col grid-row-date-start">
                                            <filters-available-from></filters-available-from>
                                        </div>
                                        <!-- end date -->
                                        <div class="grid-row-col grid-row-date-end">
                                            <filters-available-to></filters-available-to>
                                        </div>
                                        <!-- theme -->
                                        <div class="grid-row-col">
                                            <filters-theme change.delegate="filterChangeTheme($event)"></filters-theme>
                                        </div>
                                    </div>
                                    <!-- 2nd row -->
                                    <div class="grid-row">
                                        <!-- <div class="grid-content shrink" style="margin-top: 0.5rem;">
                                                <input id="checkbox-brand" type="checkbox">
                                        </div> -->
                                        <!-- Brand -->
                                        <div class="grid-row-col">
                                            <filters-designer change.delegate="filterChangeBrand($event)" ></filters-designer>
                                        </div>
                                        <!-- Seasons -->
                                        <div class="grid-row-col">
                                            <filters-season-press season.bind="season" change.delegate="filterChangeSeason($event)"></filters-season-press>
                                        </div>
                                        <div class="grid-row-col">
                                            <filters-category change.delegate="filterChangeCategory($event)"></filters-category>
                                        </div>
                                        <!-- Type
                                        <div class="grid-row-col">
                                            <filters-type></filters-type>
                                        </div> -->
                                        <!--- Color -->
                                        <div class="grid-row-col">
                                           <filters-color change.delegate="filterChangeColor($event)"></filters-color>
                                        </div>
                                    </div>
                            </div>
                    <!-- PRESS filters END -->

                    <!-- BRAND filters BEGIN -->
                    <div if.bind="user.type === 'brand'">
                        <!--<div class="blockSearchImages">
                            <div class="grid-row">
                                <div class="grid-row-col">
                                    <input type="search" value.bind="searchText" class="search-box" id="search-images" placeholder="Search Text">
                                    <!-- <filters-search></filters-search> 
                                </div>
                                <div class="grid-row-col">
                                    <filters-season season.bind="season" change.delegate="filterChangeSeason($event)"></filters-season>
                                </div>
                                <!--<div class="grid-row-col">
                                    <filters-color change.delegate="filterChangeColor($event)"></filters-color>
                                </div>
                                <div class="grid-row-col">
                                    <filters-city change.delegate="filterChangeCity($event)"></filters-city>
                                </div>
                            </div>
                        </div> -->
                        <div class="">
                            <div class="grid-row">
                                <div class="grid-row-col">
                                    <input type="search" value.bind="searchText" class="search-box" id="search-images2" placeholder="Search">
                                    <!-- <filters-search></filters-search> -->
                                </div>
                                <div class="grid-row-col">
                                    <filters-season change.delegate="filterChangeSeason($event)"></filters-season>
                                </div> 
                                <div class="grid-row-col">
                                    <filters-category change.delegate="filterChangeCategory($event)"></filters-category>
                                </div>  
                                                  
                                <div class="grid-row-col">
                                    <filters-city change.delegate="filterChangeCity($event)"></filters-city>
                                </div> 
                                
                            </div>

                            <div class="grid-row">
                                <!-- start date -->
                                <div class="grid-row-col grid-row-date-start">
                                    <filters-available-from></filters-available-from>
                                 </div>
                                    <!-- end date -->
                                <div class="grid-row-col grid-row-date-end">
                                    <filters-available-to></filters-available-to>
                                </div>
                                <!-- today -->
                                <div show.bind="availableTo" id="indexTodayBR" class="grid-row-col" >
                                    <filters-show-available  change.delegate="filterChangeShowAvailable($event)"></filters-show-available>
                                </div>
                                <div show.bind="!availableTo"  class="grid-row-col">
                                    <span class="inline-label">
                                        <span class="form-label" style="font-weight:500; color:#b7b7b7">WHERE (Set Dates)</span>
                                    </span>
                                </div>
                            </div>
                            <div class="grid-row">
                                <div class="grid-content shrink">
                                    <button id="btn-add-files" class="small button hollow" click.delegate="createAddfilesDialog()">Add Looks</button>
                                    <button class="small button hollow disabled">Delete Season</button>
                                </div>              
                            </div>
                        </div>
                    </div>
                    <!-- BRAND filters END -->


                    <!-- AGENCY filters BEGIN -->
                    <div if.bind="user.type === 'prAgency'">
                        <!--<div class="blockSearchImages">
                            <div class="grid-row">
                                <div class="grid-row-col">
                                    <input type="search" value.bind="searchText" class="search-box" id="search-images" placeholder="Search">
                                </div>
                                <div class="grid-row-col">
                                    <filters-available-from></filters-available-from>
                                </div>
                                <div class="grid-row-col">
                                    <filters-available-to></filters-available-to>
                                </div>
                                <div class="grid-row-col">
                                    <filters-city change.delegate="filterChangeCity($event)"></filters-city>
                                </div>
                            </div>
                            <div class="grid-row">
                                <div class="grid-row-col">
                                    <filters-designer-pr change.delegate="filterChangeBrand($event)" ></filters-designer-pr>
                                </div>
                                <div class="grid-row-col">
                                    <filters-season-press season.bind="season" change.delegate="filterChangeSeason($event)"></filters-season-press>
                                </div>
                                <div class="grid-row-col">
                                    <filters-color change.delegate="filterChangeColor($event)"></filters-color>
                                </div>
                                <div class="grid-row-col"></div>
                            </div>
                        </div> -->
                        <div> <!-- class="blockManageImages"> -->
                            <div class="grid-row">
                                <div class="grid-row-col">
                                    <input type="search" value.bind="searchText" class="search-box" id="search-images" placeholder="Search">
                                    <!-- <filters-search></filters-search> -->
                                </div>
                                <div class="grid-row-col">
                                    <filters-designer-pr change.delegate="filterChangeBrand($event)" ></filters-designer-pr>
                                </div>
                                <!-- Use press fetch of (all) seasons -->
                                <div class="grid-row-col">
                                    <filters-season-press season.bind="season" change.delegate="filterChangeSeason($event)"></filters-season-press>
                                </div>                                
                                <div class="grid-row-col">
                                    <filters-category change.delegate="filterChangeCategory($event)"></filters-category>
                                </div>                
           
                            </div>
                            <div class="grid-row">
                                <!-- city -->  
                                <div class="grid-row-col">
                                    <filters-city change.delegate="filterChangeCity($event)"></filters-city>
                                </div> 
                                <!-- start date -->
                                <div class="grid-row-col grid-row-date-start">
                                    <filters-available-from></filters-available-from>
                                 </div>
                                    <!-- end date -->
                                <div class="grid-row-col grid-row-date-end">
                                    <filters-available-to></filters-available-to>
                                </div>
                                <!-- today -->
                                <div show.bind="availableTo" id="indexTodayPR" class="grid-row-col availableToday" >
                                    <filters-show-available change.delegate="filterChangeShowAvailable($event)"></filters-show-available>
                                </div>
                                <div show.bind="!availableTo"  class="grid-row-col">
                                    <span class="inline-label">
                                        <span class="form-label" style="font-weight:500; color:#cccccc">WHERE (Set Dates)</span>
                                    </span>
                                </div>
                            </div>
                            <!-- not for PR's
                            <div class="grid-row">
                                <div class="grid-content shrink">
                                    <button id="btn-add-files" class="small button hollow" click.delegate="createAddfilesDialog()">Add Looks</button>
                                    <button class="small button hollow disabled">Delete Season</button>
                                </div>              
                            </div> -->
                        </div>
                    </div>
                <!-- AGENCY filters END --> 
                </div>
                <!-- -->
                <!-- Images/Looks -->
                <!-- -->

                <div id="mainScrollWindow" class="cards-list-wrap" style="visibility: hidden;"> <!-- only for the firsttime around -->
                
                        <div class="cards-list" repeat.for="row of rows" >

                            <div class="card" repeat.for="i of row.numberImagesThisRow" css="width: ${row.numberImagesThisRowPC}%;">
                                <!-- Three dots menu press -->
                                <div if.bind="user.type === 'press'" class="look-menu-absolute-wrap">
                                    <a href="#" class="look-menu-click " click.delegate="createSampleRequestPress(row.items[i].id )">
                                        <div class="menu-stripe" ></div>
                                        <div class="menu-stripe" ></div> 
                                        <div class="menu-stripe" ></div>
                                    </a>
                                </div>
                                <!-- Three dots menu brand and prAgency-->
                                <div if.bind="user.type !== 'press'" class="look-menu-absolute-wrap" >
                                    <a href="#" id="image-${row.items[i].id}" class="look-menu-click" click.delegate="lookMenu(row.items[i].id)" >
                                        <div class="menu-stripe" ></div>
                                        <div class="menu-stripe" ></div>
                                        <div class="menu-stripe" ></div>
                                    </a>

                                    <!-- Menu on image when three dots clicked -->                            
                                    <div class="look-menu-absolute" id="look-${row.items[i].id}">
                                        <div class="look-menu-wrap">
                                            <div class="look-menu-heading">
                                                ${row.items[i].season | seasonAbbreviation:seasons }.${row.items[i].name} <!-- ${i} ${row.numberImagesThisRow} -->
                                            </div>

                                            <!-- brand -->
                                            <ul if.bind="user.type === 'brand'" class="look-menu-list">                                        
                                                <li class="pure-menu-item"><a href="#" click.delegate="editSearchableItem(row.items[i].id)" class="look-menu-link">Edit</a></li>

                                                <!-- Nobody loves me...
                                                <li class="pure-menu-item"><a href="#" click.delegate="setAvailabilitySearchableItem(row.items[i])" class="look-menu-link">Set Initial Availability</a></li>
                                                -->

                                                <li class="pure-menu-item"><a href="#" click.delegate="checkAvailabilitySearchableItem(row.items[i].id)" class="look-menu-link">Check Availability</a></li>
                                                <li if.bind="(sampleRequestService.sampleRequestStatus === 'none')" class="look-menu-item"><a href="#" click.delegate="createSampleRequestBrand(row.items[i] )" class="look-menu-link">Start Booking &nbsp;</a></li>
                                                <li if.bind="(sampleRequestService.sampleRequestStatus === 'created')" class="look-menu-item"><a href="#" click.delegate="createSampleRequestBrand(row.items[i] )" class="look-menu-link">Pick &nbsp;</a></li>

                                                <li class="look-menu-item"><a href="#" click.delegate="deleteSearchableItem(row.items[i])" class="look-menu-link">Delete</a></li>
                                            </ul>
                                            <!-- agency -->
                                            <ul if.bind="user.type === 'prAgency'" class="look-menu-list">

                                                <li class="pure-menu-item"><a href="#" click.delegate="editSearchableItem(row.items[i].id)" class="look-menu-link">Edit</a></li>

                                                <!-- Nobody loves me...
                                                <li class="pure-menu-item"><a href="#" click.delegate="setAvailabilitySearchableItem(row.items[i].id)" class="look-menu-link">Set Initial Availability</a></li>
                                                -->

                                                <li class="pure-menu-item"><a href="#" click.delegate="checkAvailabilitySearchableItem(row.items[i].id)" class="look-menu-link">Check Availability</a></li>
                                                
                                                <li if.bind="(sampleRequestService.sampleRequestStatus === 'none')" class="look-menu-item"><a href="#" click.delegate="createSampleRequestBrand(row.items[i] )" class="look-menu-link">Start Booking &nbsp;</a></li>

                                                <li if.bind="(sampleRequestService.sampleRequestStatus === 'created')" class="look-menu-item"><a href="#" click.delegate="createSampleRequestBrand(row.items[i] )" class="look-menu-link">Pick &nbsp;</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div> 

                                <!-- Image Container for Look-->
                                <div id="card-${row.items[i].id}" class="card-image">
                                    
                                    
                                    <!-- Main Look image -->
                                    <img class="b-lazy" src="/assets/bgGrey.jpg" data-src="${row.items[i].image}" ref="image" 
                                     click.delegate="createZoomDialog(row.items[i],$parent.$index, i)"/> 


                                    <img if.bind="row.items[i].imageProvider=='indigital'" src="/assets/LOGO_indigitalimagesRM.png" class="indigital-and-align"/> 


                                    <!-- lower corner look number -->
                                    <div if.bind="user.type === 'brand'" class="card-look-number" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)">${row.items[i].name}</div>
                                    
                                    <!-- hover stuff -->
                                    <div class="card-look-number-name" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)">${row.items[i].name}</div>
                                    <div if.bind="user.type === 'brand'" class="card-look-number-brand-season" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)">${row.items[i].season}</div>
                                    <div if.bind="user.type === 'press'" class="card-look-number-brand-season" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)">${row.items[i].brand} <br> ${row.items[i].season}</div>
                                    <div if.bind="user.type === 'prAgency'" class="card-look-number-brand-season" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)">${row.items[i].brand} <br> ${row.items[i].season}</div>

                                    <div class="card-hover-overlay" click.delegate="createZoomDialog(row.items[i],$parent.$index, i)"></div>

                                </div>  
                        </div>                  
                    </div>
                </div>
                <!-- white lip at bottom of scroll region -->
                <div class="grid-content shrink scrolling-lip">
                </div>
            </div>
            <!-- spacer -->
            <div class="grid-block shrink spa-h-spacer">
            </div>

<!-- -->
<!-- SMALL REQUEST MANAGER -->
<!-- -->

            <div if.bind="imagePanelSize <= 2" id="left-panel" class="vertical grid-block grid-block-vertical-shadow">
                <!-- header -->
                <div class="grid-block tool-header shrink">
                    <div class="grid-block align-left tool-header tool-header-spacer">
                    </div>
                    <div class="grid-block align-left tool-header-spacer">
                        <span class="ui-text-label-m-broad ">BOOKING MANAGER (${numberOfRequests})</span>
                        <!-- <span class="alert-box">3</span> -->
                    </div>
                    <div class="grid-block align-right tool-header-spacer" style="padding-right:7px;">
                        <span class="expando">
                      <a route-href="route: requestman;"><img class="expandoHover" src="/assets/nav/expando16.png" /></a>
                    </span>
                    </div>
                </div>
                <!-- Calendar // Remove for beta release
                <div class="grid-block shrink">
                    <compose view-model="calendar"></compose>
                </div> -->
                <!-- search and filter requests -->
                <div class="vertical grid-block shrink" style="margin-left: 1rem; margin-right: 1rem;">
                    <form style="margin-top:1rem;">
                        <!-- Search requests -->
                        <input type="search" value.two-way="searchTextRequests" class="search-box" id="search-requests" placeholder="Search" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search'">
                        <!-- filter requests -->
                        <span class="inline-label" style="width:258px; margin-bottom: 0px; margin-top:1.5rem;">
                            <filters-filterrequests change.delegate="filterChange($event)" style="width:258px;"></filters-filterrequests> 
                        </span>

                        <!-- City -->
                        <!-- is no longer Relvant for categorizing sample requests -->
                        <!-- as move to company based interpretation of onlyShowMine -->
                       <!--  <span if.bind="((user.type === 'brand') || (user.type==='prAgency'))" class="inline-label" style="margin-top:1rem; margin-bottom: 0px; width:258px; margin-top:0.5rem;">
                             <filters-city change.delegate="filterChangeCityRM($event)"></filters-city>
                        </span> -->

                        <!-- ORDER -->     
                        <span class="inline-label" style="margin-top:1rem; width:258px; margin-top:0.5rem;">
                            <filters-order change.delegate="orderChange($event)" style="width:258px;"></filters-order> 
                        </span>
                       <!--  <span class="form-label" style="font-weight:500;">ORDER</span>
                        <select name="" id="">
                            <option>By Start Date</option>
                            <option>By Person</option>
                            <option>By Request Number</option>
                        </select>
                        </span> -->
                    </form>
                </div>
                <!-- Accordion -->
                
                <!-- row button + content -->
               
                <div if.bind="((user.type === 'brand') || (user.type === 'prAgency'))" class="vertical grid-content grid-content-column accordion">
                    <!--header -->
                    <div style="margin-bottom:5px; width:250px;">
                        <table class="accordion" style="table-layout:fixed;">
                            <tr> 
                                <th class="accordion w7"></th>
                                <th class="accordion w16">ID</th>
                                <th class="accordion w33">OUT</th>
                                <th class="accordion w34">STATUS</th>
                                <th class="accordion w10"></th>
                            </tr>
                        </table>
                    </div>
                    <!-- row with button -->
                    <div style="width:250px;" repeat.for="booking of bookings | sort: ordering : 'ascending' | filter:searchTextRequests:filterFunc:filtering:user:seasons:cityFiltering:onlyShowMine:onlyShowMineCompany">
                        <table class="accordion" style="table-layout:fixed;">
                            <tr class="indexReqRow  
                                    ${(sampleRequestService.sampleRequest.id === booking.id && 
                                    booking.requestStatusBrand != 'Finalizing' && 
                                    booking.requestStatusBrand != 'Approved' && 
                                    booking.requestStatusBrand != 'Returning' && 
                                    booking.requestStatusBrand != 'Out' && 
                                    booking.requestStatusBrand != 'Picked Up' && 
                                    booking.requestStatusBrand != 'Picking Up' && 
                                    booking.requestStatusBrand != 'Returning' && 
                                    booking.requestStatusBrand != 'Returned' && 
                                    booking.requestStatusBrand != 'Withdrawn' && 
                                    booking.requestStatusBrand != 'Denied' && 
                                    booking.requestStatusBrand != 'In House' && 
                                    booking.requestStatusBrand != 'Delivering' )  
                                        ? 'ui-text-label-m' : ''}">
                                <td class="accordion w7">
                                    <button id="button${booking.id}" class="accordion requestButton expandoHover" style="background-color: white" click.delegate="closeExpand(booking.id)"></button>
                                </td>
                                <td class="accordion w16">${booking.id}</td>
                                <td class="accordion w33 
                                           ${computedOverdue(booking.bookingStartDate, booking.requestStatusBrand) ? 'red-deco' : ''}">${booking.bookingStartDate | viewDateFormat}</td>
                                <td class="accordion w34
                                           ${(booking.requestStatusBrand=='Pending') ? 'ui-text-label-m-blue' : ''}" >
                                           ${(sampleRequestService.sampleRequest.id === booking.id && 
                                           booking.requestStatusBrand != 'Finalizing' && 
                                           booking.requestStatusBrand != 'Approved' && 
                                           booking.requestStatusBrand != 'Returning' && 
                                           booking.requestStatusBrand != 'Out' && 
                                           booking.requestStatusBrand != 'Picked Up' && 
                                           booking.requestStatusBrand != 'Picking Up' && 
                                           booking.requestStatusBrand != 'Returning' && 
                                           booking.requestStatusBrand != 'Returned' && 
                                           booking.requestStatusBrand != 'Withdrawn' && 
                                           booking.requestStatusBrand != 'Denied' && 
                                           booking.requestStatusBrand != 'In House' && 
                                           booking.requestStatusBrand != 'Delivering' ) 
                                                ? 'Picking' : booking.requestStatusBrand}
                                           </td>
                                <!-- ... disabled  -->
                                <td if.bind="(booking.requestStatusBrand == 'Deleted')" class="accordion w10" style="overflow:visible;">
                                    <div class="look-menu-absolute-wrap">
                                        <span class="edit-box disabled" ></span>
                                    </div>
                                </td>
                                <!-- ... not disabled -->
                                <td if.bind="(booking.requestStatusBrand != 'Deleted')" class="accordion w10" style="overflow:visible;">
                                    <div class="look-menu-absolute-wrap">
                                        <span class="edit-box" ><a href="#" class="expandoHover" click.delegate="sampleRequestMenu(booking.id)">...</a></span>
                                        <!-- edit request modal BRAND popup -->
                                         <div class="look-menu-absolute" id="requestTest${booking.id}">
                                            <span class="look-menu-heading">BOOKING ${booking.id}</span>
                                            <ul class="look-menu-list">
                                                <!-- Edit -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Pending') ||
                                                    (booking.requestStatusBrand == 'Approved') ||
                                                    (booking.requestStatusBrand == 'Returning') ||
                                                    (booking.requestStatusBrand == 'Out') ||
                                                    (booking.requestStatusBrand == 'Picked Up')
                                                )" 
                                                class="look-menu-item"><a click.delegate="editSampleRequest(booking.id)" href="#" class="look-menu-link">Edit</a></li>

                                                <!--Deny -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Pending') ||
                                                    (booking.requestStatusBrand == 'Approved') 
                                                )"
                                                class="look-menu-item"><a click.delegate="denySampleRequest(booking.id)" href="#" class="look-menu-link">Deny</a></li>    

                                                <!-- Approve -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Pending')
                                                )"
                                                class="look-menu-item"><a click.delegate="approveSampleRequest(booking.id)" href="#" class="look-menu-link">Approve</a></li>

                                                <!-- Send 
                                                <li class="look-menu-item"><a click.delegate="sendSampleRequest(booking.id)" href="#" class="look-menu-link">Send</a></li> -->

                                                <!-- Picking Up :: Does not exist now, as no "Ship" and too many states
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Approved') 
                                                )"
                                                class="look-menu-item"><a click.delegate="markPickingUpSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Picking Up</a></li> -->

                                                <!-- Picked Up -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Approved')  
                                                )"
                                                class="look-menu-item"><a click.delegate="markPickedUpSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Picked Up</a></li>

                                                <!-- Returned -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Out') ||
                                                    (booking.requestStatusBrand == 'Picked Up')||
                                                    (booking.requestStatusBrand == 'Picking Up')||
                                                    (booking.requestStatusBrand == 'Returning')
                                                )"
                                                class="look-menu-item"><a click.delegate="markReturnedSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Returned</a></li>

                                                <!-- Restocked -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Returned')
                                                )"
                                                class="look-menu-item"><a click.delegate="restockedSampleRequest(booking.id)" href="#" class="look-menu-link">Mark Restocked</a></li>

                                                <!-- Finalize -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Finalizing')
                                                )"
                                                class="look-menu-item"><a click.delegate="trolley(booking.id)" href="#" class="look-menu-link">Finalize</a></li>

                                                <!-- Not Submitted -->
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Not Submitted') &&
                                                    (sampleRequestService.sampleRequest.id != booking.id)
                                                )"
                                                class="look-menu-item"><a click.delegate="picking(booking.id)" href="#" class="look-menu-link">Continue Picking</a></li>
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Not Submitted' && booking.searchableItemsProposed.length != 0)
                                                )"
                                                class="look-menu-item"><a click.delegate="submit(booking.id)" href="#" class="look-menu-link">Finish Picking</a></li>
                                                <li if.bind="(
                                                    (booking.requestStatusBrand == 'Picking' && booking.searchableItemsProposed.length != 0)
                                                )"
                                                class="look-menu-item"><a click.delegate="submit(booking.id)" href="#" class="look-menu-link">Finish Picking</a></li>
                                                
                                                <!-- Delete -->
                                                <li class="look-menu-item"><a click.delegate="deleteSampleRequest(booking.id)" href="#" class="look-menu-link">Delete Booking</a></li>
                                            </ul>
                                        </div>
                                    </div>    
                                </td>
                            </tr>
                        </table>

                        <!-- expanding data -->
                        <div id="panel${booking.id}" class="panel requestPanel vertical grid-block" style="margin-left: 0rem; margin-bottom: 1rem;overflow:hidden;">
                           <!--  <span class="accordion expanded" style="background-color: #fafafa; width:100%; padding-top:7px; padding-left:10px; padding-bottom:7px;">Request: ${booking.id}</span> -->
                            
                            

                            <table class="accordion expanded" style="table-layout:fixed;">
                                <tr style="padding-bottom:7px;" repeat.for="sample of booking.searchableItems">
     
                                    <td if.bind="(sample.clientID)" class="accordion to-u-c" style="width:142px; max-width:142px; overflow: hidden; padding-right:10px; padding-bottom:3px;"">${sample.brand.name}/${sample.season.id | seasonAbbreviationId:seasons }.${sample.lookNameNumber}${sample.lookNameVariant}.${sample.clientID}/${sample.sampleType}</td>
                                    <td if.bind="!(sample.clientID)" class="accordion to-u-c" style="width:142px; max-width:142px; overflow: hidden; padding-right:10px; padding-bottom:3px;"">${sample.brand.name}/${sample.season.id | seasonAbbreviationId:seasons }.${sample.lookNameNumber}${sample.lookNameVariant}.P${sample.id}/${sample.sampleType}</td>
                                </tr>

                            </table>


                        </div>
                    </div>
                    <!-- Empty notice -->
                    <div if.bind="(numberOfRequests == 0)">
                        <span style="margin-top: 2rem; display:block; text-align:center;"> - No Bookings Match Your Search - </span>
                    </div>
                     
                </div>
               
                <div if.bind="(user.type === 'press')"  class="vertical grid-content grid-content-column accordion">
                    <!--header -->
                    <div style="margin-bottom:5px;">
                        <table class="accordion" style="table-layout:fixed;">
                            <tr>
                                <th class="accordion w7"></th>
                                <th class="accordion w24">LOOK</th>
                                <th class="accordion w31">START</th>
                                <th class="accordion w27">STATUS</th>
                                <th class="accordion w10"></th>
                            </tr>
                        </table>
                    </div>
                    <!-- row with button -->
                    <div repeat.for="booking of bookings | sort: ordering : 'ascending' | filter:searchTextRequests:filterFunc:filtering:user:seasons:cityFiltering:onlyShowMine:onlyShowMineCompany">
                        <table class="accordion" style="table-layout:fixed;">
                            <tr class="indexReqRow">
                                <td class="accordion w7">
                                    <button id="button${booking.id}" class="accordion requestButton expandoHover" style="background-color: white" click.delegate="closeExpand(booking.id)"></button>
                                </td>
                                <td class="accordion w24">${booking.season | seasonAbbreviation:seasons }.${booking.look}</td>
                                <td class="accordion w31 ${computedOverdue(booking.bookingStartDate, booking.requestStatusPress) ? 'red-deco' : ''}">${booking.bookingStartDate | viewDateFormat}</td>
                                <td class.bind="(booking.requestStatusPress=='Pending') ? 'accordion ui-text-label-m-blue w27' :'accordion w27'" >${booking.requestStatusPress}</td>

                                <!-- ... disabled -->
                                <td if.bind="(
                                    (booking.requestStatusPress == 'Denied') ||
                                    (booking.requestStatusPress == 'Deleted') ||
                                    (booking.requestStatusPress == 'Returned') ||
                                    (booking.requestStatusPress == 'Picked Up') ||
                                    (booking.requestStatusPress == 'Withdrawn') 
                                    )"


                                class="accordion w10" style="overflow:visible;"> 
                                    <div class="look-menu-absolute-wrap">
                                        <span class="edit-box disabled" ></span>
                                    </div>
                                </td>

                                <!-- ... not disabled -->
                                <td if.bind="(
                                    (booking.requestStatusPress != 'Denied') &&
                                    (booking.requestStatusPress != 'Deleted') &&
                                    (booking.requestStatusPress != 'Returned') &&
                                    (booking.requestStatusPress != 'Picked Up') &&
                                    (booking.requestStatusPress != 'Withdrawn') 
                                    )"

                                class="accordion w10" style="overflow:visible;"> 
                                    <div class="look-menu-absolute-wrap">
                                        <span class="edit-box" ><a href="#" class="expandoHover"  click.delegate="sampleRequestMenu(booking.id)">...</a></span>
                                        <!-- edit request modal PRESS popup -->
                                         <div class="look-menu-absolute" id="requestTest${booking.id}">
                                            <span class="look-menu-heading">BOOKING ${booking.id}</span>
                                            <ul class="look-menu-list">
                                                <!-- Edit -->
                                                <li if.bind="(
                                                    (booking.requestStatusPress == 'Pending') ||
                                                    (booking.requestStatusPress == 'In House')||
                                                    (booking.requestStatusPress == 'Approved')
                                                )"
                                                class="look-menu-item"><a href="#" click.delegate="editSampleRequest(booking.id)" class="look-menu-link">Edit</a></li>

                                                <!-- Received -->
                                                <li if.bind="(
                                                    (booking.requestStatusPress == 'Approved') ||
                                                    (booking.requestStatusPress == 'Delivering')
                                                )"
                                                class="look-menu-item"><a href="#" click.delegate="pressMarkReceivedSampleRequest(booking.id)" class="look-menu-link">Mark Received</a></li>

                                                <!-- Ship :: no longer valid with Stuart changes to edit dialog
                                                <li class="look-menu-item"><a href="#" click.delegate="pressShipSampleRequest(booking.id)"  class="look-menu-link">Ship</a></li>
                                                -->

                                                <!-- Picked Up -->
                                                <li if.bind="(
                                                    (booking.requestStatusPress == 'In House') 
                                                )"
                                                class="look-menu-item"><a href="#" click.delegate="pressMarkPickedUpSampleRequest(booking.id)"  class="look-menu-link">Mark Picked Up</a></li>

                                                <!-- Withdraw -->
                                                <li if.bind="(
                                                    (booking.requestStatusPress == 'Pending') ||                                                   
                                                    (booking.requestStatusPress == 'Approved')
                                                )"
                                                class="look-menu-item"><a href="#" click.delegate="pressDeleteSampleRequest(booking.id)"  class="look-menu-link">Withdraw Booking</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- expanding data -->
                        <div id="panel${booking.id}" class="panel requestPanel vertical grid-block" style="margin-left: 0rem; margin-bottom: 1rem;overflow:hidden;">
                            <span class="accordion expanded" style="background-color: #fafafa; width:100%; padding-top:7px; padding-left:10px; padding-bottom:7px;">Booking: ${booking.id}</span>
                            <span if.bind="booking.brand.name" class="accordion expanded" style="background-color: #fafafa;width:100%; padding-left:10px; padding-bottom:7px;">Brand: ${booking.brand.name}</span>
                            <table class="accordion expanded" style="table-layout:fixed;">
                                <tr style="padding-bottom:7px;" repeat.for="sample of booking.searchableItems">
                                    <td class="accordion" style="width:60px; max-width:60px; padding-left: 10px; padding-bottom:7px;"">${booking.season | seasonAbbreviation:seasons }.${booking.look}.${$index+1}</td>
                                    <td class="accordion to-u-c" style="width:142px; max-width:142px; overflow: hidden; padding-right:10px; padding-bottom:3px;""> ${sample.attributes}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <!-- Empty notice -->
                    <div if.bind="(numberOfRequests == 0)">
                        <span style="margin-top: 2rem; display:block; text-align:center;"> - No Requests Match Your Search - </span>
                    </div>  
                
                </div>
                <!-- white lip at bottom of scroll region -->
                <div class="grid-content shrink scrolling-lip">
                </div>
            </div>


        </div>

</template>
